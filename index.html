<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Disk Usage Reporting</title>

<!-- External Scripts -->
<script type="text/javascript" src="js/external/jquery.min.js"></script>
<script type="text/javascript" src="js/external/jquery.ui.core.js"></script>
<script type="text/javascript" src="js/external/jquery.ui.widget.js"></script>
<script type="text/javascript" src="js/external/jquery.ui.mouse.js"></script>
<script type="text/javascript" src="js/external/jquery.ui.position.js"></script>
<script type="text/javascript" src="js/external/jquery.sortelements.js"></script>
<script type="text/javascript" src="js/external/jquery.json.js"></script>
<script type="text/javascript" src="js/external/rsh.js"></script>
<script type="text/javascript" src="js/general.js"></script>
<script type="text/javascript" src="js/viewer.js"></script>

<style type="text/css">
	tbody th {
		text-align: right;
	}
</style>

<!-- Disk Usage Reporting Scripts -->
<script type="text/javascript">
	
	document.parseLocation = function(location) {
		var parsed = location.parseQS();
	};
	
	window.dhtmlHistory.create({
		toJSON: function(o) {
			return $.toJSON(o);
		},
		fromJSON: function(s) {
			return $.evalJSON(s);
		}
	});
	
	window.onload = function() {
		dhtmlHistory.initialize();
		dhtmlHistory.addListener(function(newLocation, historyData) {
			$(document).trigger('dhtmlhistory', [ newLocation, historyData ]);
		});
	};
	
	// Set up history handling.
	$(document).bind('dhtmlhistory', function(e, location, data) {
		if (document.viewer) document.viewer.display(location);
	});
	
	$(function() {
		document.reportsBaseURL = '/php/diskusage-data/';
		
		$.ajax({
			cache: false,
			url: document.reportsBaseURL + window.location.search.substring(1) + '/settings',
			type: 'GET',
			dataType: 'json',
			error: function(xhr, status, err){
				alert('Failed to get settings: ' + status);
			},
			success: function(settings, status, xhr){
				document.viewer = new Viewer({
					settings: settings,
					report: window.location.search.substring(1)
				});
				
				document.viewer.display(dhtmlHistory.getCurrentLocation(), function(){
					$('#Loading').hide();
					$('#Report').show();
				});
			}
		});
	
		// Load the location on first load.
		if (dhtmlHistory.isFirstLoad()) {
			//document.parseLocation(dhtmlHistory.getCurrentLocation());
		}
	});
</script>
</head>
<body>
	
<div id="Loading">Loading...</div>

<div id="Report" style="display: none;">
	
	<h1 id="Path"></h1>
	
	<table border="1" cellspacing="0" cellpadding="4">
		<tbody>
			<tr>
				<td colspan="2" align="center"><b>This Directory</b></td>
			</tr>
			<tr>
				<th>Files:</th>
				<td id="Num"></td>
			</tr>
			<tr>
				<th>Bytes:</th>
				<td id="Bytes"></td>
			</tr>
			<tr>
				<td colspan="2" align="center"><b>Including Sub Directories</b></td>
			</tr>
			<tr>
				<th>Files:</th>
				<td id="TotalNum"></td>
			</tr>
			<tr>
				<th>Bytes:</th>
				<td id="TotalBytes"></td>
			</tr>
		</tbody>
	</table>
	
	<div id="Sections">
	
		<div id="Section_SubDirs">
			<h2>Sub Directories:</h2>
			<table id="SubDirs" border="1" cellspacing="0" cellpadding="4">
				<thead>
					<tr>
						<th>Name</th>
						<th colspan="3">Total Bytes</th>
						<th colspan="3">Count</th>
					</tr>
				</thead>
				<tfoot>
					<td>Totals</td>
					<td colspan="3"></td>
					<td colspan="3"></td>
				</tfoot>
				<tbody>
					
				</tbody>
			</table>
		</div>
		
		<div id="Section_Modified">
			<h2>Last Modified:</h2>
			<table id="Modified" border="1" cellspacing="0" cellpadding="4">
				<thead>
					<tr>
						<th>Age</th>
						<th colspan="3">Total Bytes</th>
						<th colspan="3">Count</th>
					</tr>
				</thead>
				<tfoot>
					<td>Totals</td>
					<td colspan="3"></td>
					<td colspan="3"></td>
				</tfoot>
				<tbody>
					
				</tbody>
			</table>
		</div>
		
		<div id="Section_Sizes">
			<h2>File Sizes:</h2>
			<table id="Sizes" border="1" cellspacing="0" cellpadding="4">
				<thead>
					<tr>
						<th>Range</th>
						<th colspan="3">Total Bytes</th>
						<th colspan="3">Count</th>
					</tr>
				</thead>
				<tfoot>
					<td>Totals</td>
					<td colspan="3"></td>
					<td colspan="3"></td>
				</tfoot>
				<tbody>
					
				</tbody>
			</table>
		</div>
		
		<div id="Section_Types">
			<h2>File Types:</h2>
			<table id="Types" border="1" cellspacing="0" cellpadding="4">
				<thead>
					<tr>
						<th>Type</th>
						<th colspan="3">Total Bytes</th>
						<th colspan="3">Count</th>
					</tr>
				</thead>
				<tfoot>
					<td>Totals</td>
					<td colspan="3"></td>
					<td colspan="3"></td>
				</tfoot>
				<tbody>
					
				</tbody>
			</table>
		</div>
		
		<div id="Section_Files">
			<h2>Files:</h2>
			<table id="Files" border="1" cellspacing="0" cellpadding="4">
				<thead>
					<tr>
						<th>Name</th>
						<th>Type</th>
						<th>Size</th>
						<th>Modified</th>
					</tr>
				</thead>
				<tbody>
					
				</tbody>
			</table>
		</div>
	
	</div>

</div>

</body>
</html>